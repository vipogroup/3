# 📋 תוכנית עבודה לתיקונים - מערכת VIPO

**תאריך:** 27 בדצמבר 2025  
**מבוסס על:** 8 דוחות בדיקה  
**סטטוס:** מוכן לביצוע

---

## 📊 סיכום משימות

| קטגוריה | חובה | מומלץ | לעתיד | סה"כ |
|---------|------|-------|-------|------|
| אבטחה | 0 | 2 | 0 | 2 |
| Backend | 1 | 2 | 4 | 7 |
| Frontend/UX | 1 | 4 | 3 | 8 |
| עסקי | 0 | 3 | 2 | 5 |
| **סה"כ** | **2** | **11** | **9** | **22** |

---

## 🔴 שלב 1: חובה לפני השקה (1-2 ימים)

### 1.1 הגדרת ENV בפרודקשן
**מאמץ:** 30 דקות | **עדיפות:** קריטי

| משתנה | שירות | פעולה |
|-------|-------|-------|
| `PAYPLUS_API_KEY` | תשלומים | הגדר ב-Vercel |
| `PAYPLUS_SECRET` | תשלומים | הגדר ב-Vercel |
| `PAYPLUS_WEBHOOK_SECRET` | תשלומים | הגדר ב-Vercel |
| `SENDGRID_API_KEY` | Email | הגדר ב-Vercel |
| `TWILIO_ACCOUNT_SID` | SMS | הגדר ב-Vercel |
| `TWILIO_AUTH_TOKEN` | SMS | הגדר ב-Vercel |
| `TWILIO_FROM_NUMBER` | SMS | הגדר ב-Vercel |

**איך לבצע:**
```bash
# ב-Vercel Dashboard:
# Settings → Environment Variables → Add
```

---

### 1.2 תיקון Atomic Stock Update
**מאמץ:** 30 דקות | **עדיפות:** גבוה | **קובץ:** `app/api/orders/create/route.js`

**בעיה:** Race condition - שתי הזמנות במקביל יכולות לגרום ל-overselling

**קוד נוכחי (בעייתי):**
```javascript
if (product.stockCount >= quantity) {
  await products.updateOne(
    { _id: new ObjectId(productId) },
    { $inc: { stockCount: -quantity } }
  );
}
```

**קוד מתוקן (אטומי):**
```javascript
const result = await products.findOneAndUpdate(
  { 
    _id: new ObjectId(productId),
    stockCount: { $gte: quantity }  // בדיקה אטומית
  },
  { 
    $inc: { stockCount: -quantity },
    $set: { updatedAt: new Date() }
  },
  { returnDocument: 'after' }
);

if (!result) {
  return NextResponse.json({ ok: false, error: 'insufficient stock' }, { status: 400 });
}
```

---

## 🟠 שלב 2: מומלץ מאוד (שבוע 1)

### 2.1 יצירת דף "אודותינו"
**מאמץ:** 1 יום | **עדיפות:** גבוה

**צור קובץ:** `app/about/page.jsx`

**תוכן מומלץ:**
- מי אנחנו
- החזון שלנו
- איך זה עובד
- צוות / מייסדים
- פרטי יצירת קשר

---

### 2.2 יצירת דף מדיניות החזרות
**מאמץ:** 2 שעות | **עדיפות:** גבוה (חובה חוקית)

**צור קובץ:** `app/returns-policy/page.jsx`

**תוכן נדרש:**
- מדיניות ביטול עסקה (14 יום)
- תנאי החזרת מוצר
- אחריות
- יצירת קשר

---

### 2.3 הוספת מספר טלפון לתמיכה
**מאמץ:** 10 דקות | **עדיפות:** בינוני

**קבצים לעדכון:**
- `app/components/UserHeader.jsx` - הוסף בפוטר
- `app/contact/page.jsx` - עדכן פרטי קשר

---

### 2.4 שינוי כפתור "Join" לעברית
**מאמץ:** 10 דקות | **עדיפות:** בינוני

**קובץ:** `app/components/UserHeader.jsx`

```jsx
// שנה מ:
<Link href="/join">Join</Link>

// ל:
<Link href="/join">הצטרף כסוכן 💰</Link>
```

---

### 2.5 העלאת Rate Limit ל-Login
**מאמץ:** 5 דקות | **עדיפות:** בינוני

**קובץ:** `lib/rateLimit.js`

```javascript
// שנה מ:
login: createLimiter('login', { maxRequests: 5, windowMs: 60000 }),

// ל:
login: createLimiter('login', { maxRequests: 10, windowMs: 60000 }),
```

---

### 2.6 הסרת Console.log מיותרים
**מאמץ:** 30 דקות | **עדיפות:** נמוך

**פקודה לחיפוש:**
```bash
grep -r "console.log" app/api/ --include="*.js" | wc -l
# נמצאו: 64 קריאות
```

**המלצה:** הסר או החלף ב-logger מקצועי

---

## 🟡 שלב 3: לאחר השקה - 30 יום

### 3.1 החלפת iframe בדף הבית
**מאמץ:** 2 ימים | **עדיפות:** גבוה

**בעיה:** דף הבית מציג iframe של אתר חיצוני - מבלבל

**פתרון:** צור דף נחיתה חדש עם:
- הצעת ערך ברורה
- 3 שלבים "איך זה עובד"
- CTA ברור
- Social proof

**קובץ:** `app/page.jsx`

---

### 3.2 Guest Checkout
**מאמץ:** 2 ימים | **עדיפות:** גבוה

**בעיה:** חובה להירשם כדי לרכוש - נטישה של 15%

**פתרון:**
1. הוסף אפשרות "המשך כאורח"
2. בקש רק פרטים נדרשים (שם, טלפון, כתובת)
3. הצע הרשמה בסוף התהליך

**קבצים:**
- `app/checkout/page.jsx`
- `app/api/orders/create/route.js`

---

### 3.3 Onboarding לסוכנים חדשים
**מאמץ:** 3 ימים | **עדיפות:** בינוני

**בעיה:** סוכנים חדשים לא יודעים מה לעשות

**פתרון:**
1. מודאל ברוכים הבאים
2. 5 שלבים מודרכים
3. סרטון הסבר
4. יעדים ראשונים

---

### 3.4 ביקורות מוצרים
**מאמץ:** 2 ימים | **עדיפות:** בינוני

**הוסף:**
- אפשרות לכתוב ביקורת
- דירוג כוכבים
- הצגת ביקורות בדף מוצר

---

## 🟢 שלב 4: לאחר השקה - 60 יום

### 4.1 API Versioning
**מאמץ:** 2 ימים | **עדיפות:** בינוני

**שנה מ:** `/api/products`  
**ל:** `/api/v1/products`

---

### 4.2 Redis Caching
**מאמץ:** 2 ימים | **עדיפות:** בינוני

**Cache את:**
- רשימת מוצרים (5 דקות)
- פרטי משתמש (1 דקה)
- הגדרות מערכת (10 דקות)

---

### 4.3 A/B Testing
**מאמץ:** 3 ימים | **עדיפות:** בינוני

**בדוק:**
- כפתורי CTA
- דף נחיתה
- תהליך checkout

---

### 4.4 Live Chat
**מאמץ:** 1 יום | **עדיפות:** נמוך

**אפשרויות:**
- Crisp (חינם עד 2 משתמשים)
- Tawk.to (חינם)
- Intercom (בתשלום)

---

## 🔵 שלב 5: לאחר השקה - 90 יום

### 5.1 OpenAPI Documentation
**מאמץ:** 3 ימים | **עדיפות:** נמוך

**צור:** Swagger/OpenAPI spec לכל ה-APIs

---

### 5.2 SDK למפתחים
**מאמץ:** 5 ימים | **עדיפות:** נמוך

**צור:** JavaScript SDK לאינטגרציות

---

### 5.3 APM Monitoring
**מאמץ:** 1 יום | **עדיפות:** בינוני

**אפשרויות:**
- Sentry (שגיאות)
- DataDog (ביצועים)
- LogRocket (UX)

---

## 📅 לוח זמנים מסכם

```
┌─────────────────────────────────────────────────────────────┐
│                      TIMELINE                                │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  לפני השקה (1-2 ימים)                                       │
│  ├── ENV variables                                          │
│  └── Atomic stock update                                    │
│                                                             │
│  שבוע 1                                                     │
│  ├── דף אודותינו                                            │
│  ├── מדיניות החזרות                                         │
│  ├── מספר טלפון                                             │
│  ├── כפתור Join בעברית                                      │
│  └── Rate limit                                             │
│                                                             │
│  30 יום                                                     │
│  ├── דף נחיתה חדש                                           │
│  ├── Guest checkout                                         │
│  ├── Onboarding סוכנים                                      │
│  └── ביקורות מוצרים                                         │
│                                                             │
│  60 יום                                                     │
│  ├── API versioning                                         │
│  ├── Redis caching                                          │
│  ├── A/B testing                                            │
│  └── Live chat                                              │
│                                                             │
│  90 יום                                                     │
│  ├── OpenAPI docs                                           │
│  ├── SDK                                                    │
│  └── APM monitoring                                         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## ✅ צ'קליסט לפני השקה

- [ ] ENV variables מוגדרים ב-Vercel
- [ ] Atomic stock update מתוקן
- [ ] דף אודותינו קיים
- [ ] מדיניות החזרות קיימת
- [ ] מספר טלפון מופיע באתר
- [ ] בדיקת תשלום עובדת
- [ ] בדיקת SMS/Email עובדת
- [ ] Build עובר ללא שגיאות

---

## 📞 צוות אחראי

| משימה | אחראי | דדליין |
|-------|-------|--------|
| ENV setup | DevOps | יום 1 |
| Stock fix | Backend | יום 1 |
| About page | Frontend | שבוע 1 |
| Policy page | Content | שבוע 1 |
| Landing page | Design + Frontend | 30 יום |

---

**תוכנית זו מתעדכנת ב:** 27 בדצמבר 2025
